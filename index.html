<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CompassGo Luxe</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin: 0; padding: 0; background: #050810; color: white; font-family: -apple-system, BlinkMacSystemFont, sans-serif; display: flex; justify-content: center; min-height: 100vh; overflow-x: hidden; }
        .stars-bg { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle at center, #1b2735 0%, #090a0f 100%); z-index: -1; }
        .stars-bg::after { content: ""; position: absolute; top: 0; left: 0; width: 200%; height: 200%; background-image: radial-gradient(2px 2px at 20px 30px, #eee, rgba(0,0,0,0)), radial-gradient(2px 2px at 40px 70px, #fff, rgba(0,0,0,0)); background-repeat: repeat; background-size: 250px 250px; animation: starsAnim 35s linear infinite; opacity: 0.5; }
        @keyframes starsAnim { from { transform: translateY(0); } to { transform: translateY(-50%); } }
        
        .container { width: 92%; max-width: 360px; text-align: center; margin: 30px 0; background: rgba(255, 255, 255, 0.03); padding: 25px; border-radius: 32px; backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); position: relative; z-index: 10; height: fit-content; transition: opacity 0.4s ease; }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        button, .card { background: rgba(255, 255, 255, 0.06); color: white; border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; transition: all 0.2s ease; -webkit-tap-highlight-color: transparent; outline: none; }
        button { padding: 14px 5px; font-size: 13px; font-weight: 600; cursor: pointer; }
        button.wide { grid-column: span 2; }
        button:active, .card:active { background: rgba(255, 255, 255, 0.12); transform: scale(0.97); }
        
        .card { margin-bottom: 12px; padding: 18px 20px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; animation: fadeIn 0.5s ease forwards; opacity: 0; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .hidden { display: none !important; opacity: 0; }
        #scroll-area, #menu-grid, #food-list { max-height: 65vh; overflow-y: auto; padding-right: 5px; scrollbar-width: none; }
        #scroll-area::-webkit-scrollbar, #menu-grid::-webkit-scrollbar, #food-list::-webkit-scrollbar { display: none; }
        
        h1 { font-size: 26px; margin-bottom: 10px; }
        h2 { font-size: 22px; margin-bottom: 15px; color: #fff; font-weight: 700; }
        p { opacity: 0.5; font-size: 14px; margin-bottom: 25px; }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –µ–¥—ã */
        .food-card { background: rgba(255, 255, 255, 0.08); border-radius: 24px; overflow: hidden; margin-bottom: 20px; text-align: left; border: 1px solid rgba(255, 255, 255, 0.1); }
        .food-img { width: 100%; height: 160px; object-fit: cover; }
        .food-info { padding: 15px; }
        .food-title { font-size: 18px; font-weight: 700; margin-bottom: 5px; display: block; }
        .food-desc { font-size: 13px; opacity: 0.7; margin-bottom: 10px; line-height: 1.4; }
        .food-meta { font-size: 12px; opacity: 0.5; display: flex; align-items: center; gap: 5px; margin-bottom: 12px; }
        .map-btn { width: 100%; background: #2481cc; border: none; padding: 10px; border-radius: 12px; font-size: 13px; color: white; font-weight: 600; }
    </style>
</head>
<body>
    <div class="stars-bg"></div>

    <div id="screen-langs" class="container">
        <h1>Welcome! üåç</h1>
        <p>Choose your language</p>
        <div class="grid">
            <button onclick="changeTo('ru')">–†—É—Å—Å–∫–∏–π üá∑üá∫</button>
            <button onclick="changeTo('en')">English üá∫üá∏</button>
            <button onclick="changeTo('tr')">T√ºrk√ße üáπüá∑</button>
            <button onclick="changeTo('pl')">Polski üáµüá±</button>
            <button onclick="changeTo('fr')">Fran√ßais üá´üá∑</button>
            <button onclick="changeTo('es')">Espa√±ol üá™üá∏</button>
            <button onclick="changeTo('it')">Italiano üáÆüáπ</button>
            <button onclick="changeTo('de')">Deutsch üá©üá™</button>
            <button class="wide" onclick="changeTo('cn')">‰∏≠Êñá üá®üá≥</button>
        </div>
    </div>

    <div id="screen-countries" class="container hidden">
        <h2 id="title-countries">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É üìç</h2>
        <div id="scroll-area"></div>
    </div>

    <div id="screen-inside" class="container hidden">
        <h2 id="current-country-name">Country</h2>
        <div id="menu-grid" class="grid"></div>
    </div>

    <div id="screen-subcat" class="container hidden">
        <h2 id="subcat-title">–í—ã–±–æ—Ä</h2>
        <div id="subcat-grid" class="grid"></div>
    </div>

    <div id="screen-food-list" class="container hidden">
        <h2 id="food-list-title">–ó–∞–≤–µ–¥–µ–Ω–∏—è</h2>
        <div id="food-list"></div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const backButton = tg.BackButton;
        const mainButton = tg.MainButton;
        const secondaryButton = tg.SecondaryButton;
        
        tg.expand();
        tg.ready();
        tg.setHeaderColor('#050810');

        let currentLang = 'ru';
        let selectedCountry = '';
        let currentView = 'screen-langs';
        
        const SUPPORT_LINK = "https://t.me/compassgo_support";

        // –î–ê–ù–ù–´–ï –ü–û –ï–î–ï (–°–ï–í–ï–†–ù–´–ô –ö–ò–ü–†)
        const foodData = {
            "–°–µ–≤–µ—Ä–Ω—ã–π –ö–∏–ø—Ä üáπüá∑": {
                "–ú—è—Å–æ": [
                    {
                        name: "Niazi's Restaurant",
                        desc: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω, –≥–¥–µ –∏–∑–æ–±—Ä–µ–ª–∏ 'Full Kebab'. –õ—É—á—à–µ–µ –º–µ—Å—Ç–æ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –∫–∏–ø—Ä—Å–∫–æ–π –º—è—Å–Ω–æ–π –∫—É—Ö–Ω–µ–π.",
                        time: "12:00 - 23:00",
                        img: "https://images.unsplash.com/photo-1544148103-0773bf10d330?auto=format&fit=crop&w=400",
                        map: "https://maps.app.goo.gl/niazis"
                    },
                    {
                        name: "Aspava Famagusta",
                        desc: "–û–≥—Ä–æ–º–Ω—ã–µ –ø–æ—Ä—Ü–∏–∏, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∑–∞–∫—É—Å–∫–∏ (–º–µ–∑–µ) –∏ –∞—É—Ç–µ–Ω—Ç–∏—á–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ —Å—Ç–∞—Ä–æ–≥–æ –≥–æ—Ä–æ–¥–∞.",
                        time: "11:00 - 22:00",
                        img: "https://images.unsplash.com/photo-1529193591184-b1d58069ecdd?auto=format&fit=crop&w=400",
                        map: "https://maps.app.goo.gl/aspava"
                    }
                ],
                "–§–∞—Å—Ç—Ñ—É–¥": [
                    {
                        name: "Ezi√ß Peanuts",
                        desc: "–°–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è —Å–µ—Ç—å –Ω–∞ –æ—Å—Ç—Ä–æ–≤–µ. –ó–Ω–∞–º–µ–Ω–∏—Ç—ã–µ –∫—É—Ä–∏–Ω—ã–µ –ø–∞–ª—å—á–∏–∫–∏ –∏ –±—É—Ä–≥–µ—Ä—ã —Å –≤–∏–¥–æ–º –Ω–∞ –º–æ—Ä–µ.",
                        time: "09:00 - 00:00",
                        img: "https://images.unsplash.com/photo-1561758033-d89a9ad46330?auto=format&fit=crop&w=400",
                        map: "https://maps.app.goo.gl/ezic"
                    }
                ]
                // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–†—ã–±–∞, –ï–≤—Ä–æ–ø–∞ –∏ —Ç.–¥.) –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ
            }
        };

        const countriesList = {
            ru: ["–§—Ä–∞–Ω—Ü–∏—è üá´üá∑", "–†–æ—Å—Å–∏—è üá∑üá∫", "–¢—É—Ä—Ü–∏—è üáπüá∑", "–ò—Å–ø–∞–Ω–∏—è üá™üá∏", "–ò—Ç–∞–ª–∏—è üáÆüáπ", "–ì–µ—Ä–º–∞–Ω–∏—è üá©üá™", "–ò–Ω–¥–æ–Ω–µ–∑–∏—è (–ë–∞–ª–∏) üáÆüá©", "–¢–∞–∏–ª–∞–Ω–¥ üáπüá≠", "–ö–∏—Ç–∞–π üá®üá≥", "–Ø–ø–æ–Ω–∏—è üáØüáµ", "–®—Ä–∏-–õ–∞–Ω–∫–∞ üá±üá∞", "–ö–∞—Ç–∞—Ä üá∂üá¶", "–ï–≥–∏–ø–µ—Ç üá™üá¨", "–ú–µ–∫—Å–∏–∫–∞ üá≤üáΩ", "–î–æ–º–∏–Ω–∏–∫–∞–Ω–∞ üá©üá¥", "–°–®–ê üá∫üá∏", "–ì—Ä—É–∑–∏—è üá¨üá™", "–ê—Ä–º–µ–Ω–∏—è üá¶üá≤", "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω üá∞üáø", "–ü–æ—Ä—Ç—É–≥–∞–ª–∏—è üáµüáπ", "–°–µ–≤–µ—Ä–Ω—ã–π –ö–∏–ø—Ä üáπüá∑", "–Æ–∂–Ω—ã–π –ö–∏–ø—Ä üá®üáæ", "–û–ê–≠ üá¶üá™", "–ß–µ—Ä–Ω–æ–≥–æ—Ä–∏—è üá≤üá™", "–ì—Ä–µ—Ü–∏—è üá¨üá∑", "–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è üá¨üáß", "–ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω üá¶üáø"]
            // ... –¥—Ä—É–≥–∏–µ —è–∑—ã–∫–∏ –∏–∑ –±–∞–∑–æ–≤–æ–≥–æ –∫–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
        };

        const dict = {
            ru: { t: "–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É üìç", join: "–ù–∞–ø–∏—Å–∞—Ç—å", cancel: "–û—Ç–º–µ–Ω–∞", cat: ["–ü—Ä–∞–≤–∏–ª–∞", "–†–∞–±–æ—Ç–∞", "–ï–¥–∞", "–£—Å–ª—É–≥–∏", "–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å", "–†–µ–∫–ª–∞–º–∞", "–ù–æ–≤–æ—Å—Ç–∏", "–î–æ–∫—É–º–µ–Ω—Ç—ã"], chat: "–ß–ê–¢ –°–û–û–ë–©–ï–°–¢–í–ê", support: "–ü–û–î–î–ï–†–ñ–ö–ê", kitchens: ["–ú—è—Å–æ", "–†—ã–±–∞", "–ú–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã", "–ï–≤—Ä–æ–ø–∞", "–§–∞—Å—Ç—Ñ—É–¥"] },
            en: { t: "Select Country üìç", join: "Contact", cancel: "Cancel", cat: ["Rules", "Jobs", "Food", "Services", "Property", "Ads", "News", "Documents"], chat: "COMMUNITY CHAT", support: "SUPPORT", kitchens: ["Meat", "Fish", "Seafood", "Europe", "Fastfood"] }
            // ... –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã –∏–∑ –±–∞–∑–æ–≤–æ–≥–æ –∫–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
        };

        function showScreen(id) {
            document.querySelectorAll('.container').forEach(s => s.classList.add('hidden'));
            const target = document.getElementById(id);
            target.classList.remove('hidden');
            currentView = id;
            setTimeout(() => target.style.opacity = "1", 50);
            
            if (id === 'screen-langs') {
                backButton.hide();
                mainButton.hide();
                secondaryButton.hide();
            } else {
                backButton.show();
                mainButton.show();
                secondaryButton.show();
            }
        }

        backButton.onClick(() => {
            if (currentView === 'screen-food-list') showScreen('screen-subcat');
            else if (currentView === 'screen-subcat') showScreen('screen-inside');
            else if (currentView === 'screen-inside') showScreen('screen-countries');
            else if (currentView === 'screen-countries') showScreen('screen-langs');
        });

        function changeTo(lang) {
            tg.HapticFeedback.impactOccurred('light');
            currentLang = lang;
            const data = dict[lang];
            mainButton.setParams({ text: data.chat, is_visible: true, color: '#2481cc' });
            secondaryButton.setParams({ text: data.support, is_visible: true, color: '#1c1c1e' });

            document.getElementById('title-countries').innerText = data.t;
            const list = document.getElementById('scroll-area');
            list.innerHTML = '';
            
            // –ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ
            const countries = countriesList[lang] || countriesList['ru'];
            [...countries].sort().forEach(name => {
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `<span>${name}</span> <span style="opacity:0.3">‚û°Ô∏è</span>`;
                div.onclick = () => openCountry(name);
                list.appendChild(div);
            });
            showScreen('screen-countries');
        }

        function openCountry(name) {
            tg.HapticFeedback.selectionChanged();
            selectedCountry = name;
            const data = dict[currentLang];
            document.getElementById('current-country-name').innerText = name;
            
            const grid = document.getElementById('menu-grid');
            grid.innerHTML = '';
            const icons = ["üìú", "üíº", "üç¥", "üõ†", "üè†", "üì¢", "üì∞", "üìÑ"];
            data.cat.forEach((catName, index) => {
                const btn = document.createElement('button');
                btn.className = "wide";
                btn.style.display = "flex"; btn.style.justifyContent = "center"; btn.style.alignItems = "center"; btn.style.gap = "10px";
                btn.innerHTML = `<span>${icons[index]}</span> <span>${catName}</span>`;
                btn.onclick = () => {
                    if (catName === "–ï–¥–∞" || catName === "Food" || catName === "Yemek") {
                        openFoodCategories();
                    } else {
                        tg.showActionSheet({
                            title: catName,
                            buttons: [{text: data.join, id: 'ok'}, {text: data.cancel, type: 'destructive'}]
                        }, (id) => { if(id === 'ok') handleSupportAction(); });
                    }
                };
                grid.appendChild(btn);
            });
            showScreen('screen-inside');
        }

        function openFoodCategories() {
            const data = dict[currentLang];
            document.getElementById('subcat-title').innerText = "–ö—É—Ö–Ω—è üç¥";
            const grid = document.getElementById('subcat-grid');
            grid.innerHTML = '';
            
            data.kitchens.forEach(kitchen => {
                const btn = document.createElement('button');
                btn.innerText = kitchen;
                btn.onclick = () => showFoodList(kitchen);
                grid.appendChild(btn);
            });
            showScreen('screen-subcat');
        }

        function showFoodList(kitchenType) {
            document.getElementById('food-list-title').innerText = kitchenType;
            const container = document.getElementById('food-list');
            container.innerHTML = '';

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –°–µ–≤–µ—Ä–Ω–æ–≥–æ –ö–∏–ø—Ä–∞ (–Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –≤ –ë–î)
            const countryKey = "–°–µ–≤–µ—Ä–Ω—ã–π –ö–∏–ø—Ä üáπüá∑";
            const items = (foodData[countryKey] && foodData[countryKey][kitchenType]) || [];

            if (items.length === 0) {
                container.innerHTML = '<p style="margin-top:20px">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –ª—É—á—à–∏–µ –º–µ—Å—Ç–∞!</p>';
            } else {
                items.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'food-card';
                    card.innerHTML = `
                        <img src="${item.img}" class="food-img">
                        <div class="food-info">
                            <span class="food-title">${item.name}</span>
                            <div class="food-meta">üïí ${item.time}</div>
                            <p class="food-desc">${item.desc}</p>
                            <button class="map-btn" onclick="tg.openLink('${item.map}')">üìç –ù–∞ –∫–∞—Ä—Ç–µ</button>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }
            showScreen('screen-food-list');
        }

        function handleSupportAction() {
            tg.HapticFeedback.notificationOccurred('success');
            tg.openTelegramLink(SUPPORT_LINK);
        }
    </script>
</body>
</html>
